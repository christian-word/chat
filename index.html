<script>
async function loadData() {
  try {
    // Добавляем timestamp для избежания кеширования
    const url = "https://script.google.com/macros/s/AKfycbwsy1b34GD1qwJeoJE5OfjRAK3ttWU5LEkjP_FBifnRl8Gn5qGzuPhRcHyASRTUZvLk/exec?t=" + Date.now();
    
    // Вариант 1: Через прокси
    const proxyUrl = "https://api.allorigins.win/get?url=" + encodeURIComponent(url);
    const response = await fetch(proxyUrl);
    const data = await response.json();
    const realData = JSON.parse(data.contents);
    
    // Вариант 2: Прямой запрос (если GAS настроен правильно)
    // const response = await fetch(url);
    // const realData = await response.json();
    
    console.log("Данные получены:", realData);
    // Вставьте ваш код обработки данных здесь
    
  } catch (error) {
    console.error("Ошибка:", error);
    alert("Ошибка загрузки данных. Проверьте консоль.");
  }
}

// Загружаем данные при открытии страницы
window.addEventListener('DOMContentLoaded', loadData);
</script>
