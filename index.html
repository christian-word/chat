<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Редактор масиву JSON</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #eee; }
    input { width: 100%; padding: 8px; margin-top: 4px; margin-bottom: 12px; }
    button { padding: 8px 14px; margin-right: 10px; }
    #editor { background: #fff; padding: 16px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>Редактор JSON (масив об'єктів)</h2>
  <div id="table-container">Завантаження...</div>

  <div id="editor" style="display:none">
    <h3>Редагування</h3>
    <label>ПІБ: <input type="text" id="fullname"></label><br>
    <label>Дата народження: <input type="date" id="birthdate"></label><br>
    <label>Телефон: <input type="text" id="phone"></label><br>
    <button onclick="applyChanges()">Зберегти зміни</button>
    <button onclick="cancelEdit()">Скасувати</button>
  </div>

  <button onclick="downloadJSON()">Завантажити оновлений JSON</button>

  <script>
    const fileId = "1zsSKz3rbPcjzXXGQ0MENVGyQgjIR_Ww6"; // ID твоего файла
    const publicUrl = `https://drive.google.com/uc?export=download&id=${fileId}`;

    let data = [];
    let currentIndex = -1;

    fetch(publicUrl)
      .then(res => res.json())
      .then(json => {
        data = json;
        renderTable();
      })
      .catch(err => {
        document.getElementById('table-container').innerText = "Помилка: " + err;
      });

    function renderTable() {
      let html = `<table><thead><tr>
        <th>ПІБ</th><th>Дата народження</th><th>Телефон</th><th>Дії</th>
      </tr></thead><tbody>`;
      data.forEach((person, index) => {
        html += `<tr>
          <td>${person.fullname}</td>
          <td>${person.birthdate}</td>
          <td>${person.phone}</td>
          <td><button onclick="edit(${index})">Редагувати</button></td>
        </tr>`;
      });
      html += `</tbody></table>`;
      document.getElementById('table-container').innerHTML = html;
    }

    function edit(index) {
      currentIndex = index;
      const person = data[index];
      document.getElementById('fullname').value = person.fullname || '';
      document.getElementById('birthdate').value = person.birthdate || '';
      document.getElementById('phone').value = person.phone || '';
      document.getElementById('editor').style.display = 'block';
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function applyChanges() {
      if (currentIndex === -1) return;
      data[currentIndex].fullname = document.getElementById('fullname').value;
      data[currentIndex].birthdate = document.getElementById('birthdate').value;
      data[currentIndex].phone = document.getElementById('phone').value;
      document.getElementById('editor').style.display = 'none';
      renderTable();
    }

    function cancelEdit() {
      currentIndex = -1;
      document.getElementById('editor').style.display = 'none';
    }

    function downloadJSON() {
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = "updated.json";
      a.click();
    }
  </script>
</body>
</html>
